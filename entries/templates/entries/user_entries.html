{% extends "entries/entries_base.html" %}
{% load static %}
{% load entriestags accounttags %}

{% block content %}


<div class="container-fluid row extra-top-margin">
    <h1>Entries</h1>
    {% if user|has_disclaimer %}

        {% if entries %}
        <div class="row">
            <div class="col-sm-12">
                <div class="panel panel-default">
                    <div class="table-responsive">
                        <table class="table entry-table">
                            <tr class="default">
                                <th>Category</th>
                                <th>Status</th>
                                <th>Video submission</br>fee paid</th>
                                <th colspan="2" class="table-center">For selected entries</th>
                                <th> </th>
                            </tr>
                            <tr class="default">
                                <th></th>
                                <th></th>
                                <th></th>
                                <th>Fee paid</th>
                                <th>Data complete</th>
                                <th> </th>
                            </tr>
                            {% for entry in entries %}
                                <tr {% if entry.instance.withdrawn %}class='withdrawn'{% endif %}>
                                    <td>{{ entry.instance.category|format_category }}</td>
                                    <td>{{ entry.instance|format_status }}</td>
                                    <td>
                                        {% if entry.instance.video_entry_paid %}<span class="fa fa-check"></span>
                                        {% elif entry.paypal_video_form %}{% include 'payments/video_payment.html' %}
                                        {% else %}<span class="fa fa-times"></span>{% endif %}
                                    </td>
                                    <td>
                                        {% if entry.instance.status == 'selected' or entry.instance.status == 'selected_confirmed' %}
                                            {% if entry.instance.selected_entry_paid %}<span class="fa fa-check"></span>
                                            {% elif entry.paypal_selected_form %}{% include 'payments/selected_payment.html' %}
                                            {% else %}<span class="fa fa-times"></span>{% endif %}
                                        {% else %}
                                            N/A
                                        {% endif %}
                                    </td>
                                    <td>
                                        {% if entry.instance.status == 'selected' or entry.instance.status == 'selected_confirmed' %}
                                            {% if entry.instance.song and entry.instance.biography %}<span class="fa fa-check"></span>
                                            {% else %}<span class="fa fa-times"></span>{% endif %}
                                        {% else %}
                                            N/A
                                        {% endif %}
                                    </td>
                                    <td>
                                        {% if not entry.instance.withdrawn %}
                                            {% if entry.instance.status == 'selected' or entry.instance.status == 'selected_confirmed' %}
                                                <a class="btn table-btn btn-purple" href="{% url 'entries:edit_selected_entry' entry.instance.entry_ref %}">Edit</a>
                                            {% else %}
                                                <a class="btn table-btn btn-purple" href="{% url 'entries:edit_entry' entry.instance.entry_ref %}">Edit</a>
                                            {% endif %}
                                            {% if entry.can_delete %}
                                                <a class="btn table-btn btn-danger" href="{% url 'entries:delete_entry' entry.instance.entry_ref %}">Delete</a>
                                            {% else %}
                                                <a class="btn table-btn btn-warning" href="{% url 'entries:withdraw_entry' entry.instance.entry_ref %}">Withdraw</a>
                                            {% endif %}
                                        {% else %}
                                            <span class="helptext">Contact organizers if you wish to reopen this entry</span>
                                        {% endif %}
                                    </td>
                                    </td>
                                </tr>
                            {% endfor %}
                        </table>
                    </div>
            </div>
            </div>
        </div>
        {% else %}
            <p>You do not have any entries yet.</p>
        {% endif %}

    {% else %}
    <p>Please <a href="{% url 'accounts:disclaimer_form' %}">complete a disclaimer</a> before beginning the entry process.</p>
    {% endif %}

    <p><a class="btn btn-purple {% if not user|has_disclaimer %}disabled{% endif %}" href="{% url 'entries:create_entry' %}">Start new entry</a></p>

</div>

{% endblock content %}
